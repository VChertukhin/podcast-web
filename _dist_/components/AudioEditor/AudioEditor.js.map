{"version":3,"sources":["AudioEditor.tsx"],"names":["React","useEffect","useState","Button","Group","Card","CardGrid","Separator","Spinner","Icon24Play","Icon24Pause","Icon24Music","Icon24ArrowUturnLeftOutline","Icon24ChartDown","Icon24ChartUp","Icon24Cut","WaveSurfer","TimelinePlugin","RegionsPlugin","createAudioCtx","createAudioBufferFromFile","audioBufferSlice","AudioEditor","podcast","audioFile","isBlobLoading","setIsBlobLoading","isEditable","setIsEditable","currentBuffer","setCurrentBuffer","editStory","setEditStory","shouldMusicPlay","setShouldMusicPlay","didMount","setDidMount","selectionRegion","setSelectionRegion","wavesurfer","setWavesurfer","create","barWidth","barRadius","barGap","barMinHeight","barHeight","cursorWidth","cursorColor","container","backend","height","progressColor","waveColor","responsive","plugins","labelPadding","timeInterval","pxPerSec","Math","ceil","unlabeledNotchColor","primaryFontColor","secondaryFontColor","fontSize","notchPercentHeight","loadBlob","ctx","buffer","on","Object","keys","regions","list","length","selectionReg","addRegion","start","end","getDuration","color","handleStyle","left","backgroundColor","width","right","selectedStart","selectedEnd","play","isPlaying","pause","cutAudio","console","log","remove","sllicedBuffer","load","drawBuffer","isReady","fireEvent","undoCutAudio","prevBuffer","slice","editStyles","opacity","pointerEvents","storyStyles","background","padding","minHeight","display","justifyContent","marginRight"],"mappings":"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","sourcesContent":["import React, { FunctionComponent, useEffect, useState } from 'react';\nimport {\n  Button,\n  Group,\n  Card,\n  CardGrid,\n  Separator,\n  Spinner,\n} from '@vkontakte/vkui';\nimport {\n  Icon24Play,\n  Icon24Pause,\n  Icon24Music,\n  Icon24ArrowUturnLeftOutline,\n} from '@vkontakte/icons';\nimport { Icon24ChartDown, Icon24ChartUp, Icon24Cut } from '../icons';\n\nimport type { Podcast } from '../../types';\nimport WaveSurfer from 'wavesurfer.js';\nimport TimelinePlugin from './plugins/timeline';\nimport RegionsPlugin from './plugins/regions';\nimport {\n  createAudioCtx,\n  createAudioBufferFromFile,\n  audioBufferSlice,\n} from './audioUtils';\n\ninterface IAudioEditorProps {\n  podcast: Podcast;\n}\n\n/* eslint-disable */\n\nconst AudioEditor: FunctionComponent<IAudioEditorProps> = ({ podcast }: IAudioEditorProps) => {\n  const { audioFile } = podcast;\n\n  const [isBlobLoading, setIsBlobLoading] = useState<boolean>(true);\n  const [isEditable, setIsEditable] = useState<boolean>(false);\n  const [currentBuffer, setCurrentBuffer] = useState<AudioBuffer | null>(null);\n  const [editStory, setEditStory] = useState<AudioBuffer[]>([]);\n  const [shouldMusicPlay, setShouldMusicPlay] = useState<boolean>(false);\n  const [didMount, setDidMount] = useState<boolean>(false);\n  const [selectionRegion, setSelectionRegion] = useState<any>(null);\n  // eslint-disable-next-line\n  const [wavesurfer, setWavesurfer] = useState<WaveSurfer | null>(null);\n  useEffect(() => {\n    if (!didMount) {\n\n      const wavesurfer = WaveSurfer.create({\n        barWidth: 2,\n        barRadius: 2,\n        barGap: 4,\n        barMinHeight: 2,\n        barHeight: 0.6,\n        cursorWidth: 1,\n        cursorColor: 'var(--dynamic_red)',\n        container: '#waveform',\n        backend: 'WebAudio',\n        height: 96,\n        progressColor: '#3F8AE0',\n        waveColor: '#3F8AE0',\n        responsive: true,\n        // waveColor: '#EFEFEF',\n        //cursorColor: 'transparent',\n        plugins: [\n          TimelinePlugin.create({\n            container: '#timeline',\n            labelPadding: 0,\n            timeInterval: (pxPerSec: number) => {\n              if (pxPerSec >= 25) {\n                return 1;\n              } else if (pxPerSec * 5 >= 25) {\n                return 5;\n              } else if (pxPerSec * 15 >= 25) {\n                return 10;\n              }\n              return Math.ceil(0.5 / pxPerSec) * 60;\n            },\n            unlabeledNotchColor: '#99a2ad',\n            primaryFontColor: '#99a2ad',\n            secondaryFontColor: '#99a2ad',\n            fontSize: 9,\n            height: 26,\n            notchPercentHeight: 33,\n          }),\n          RegionsPlugin.create({}),\n        ],\n      });\n      wavesurfer.loadBlob(audioFile!);\n\n      // initial buffer\n      // create audio context\n      const ctx = createAudioCtx();\n      createAudioBufferFromFile(\n        audioFile!,\n        ctx,\n        (buffer) => {\n          setCurrentBuffer(buffer);\n        },\n      );\n\n      wavesurfer.on('ready', () => {\n        setIsBlobLoading(false);\n      });\n      wavesurfer.on('interaction', () => {\n        // be sure that only one region is created\n        if (Object.keys(wavesurfer.regions.list).length === 0) {\n          const selectionReg = wavesurfer.addRegion({\n            start: 0,\n            end: wavesurfer.getDuration(),\n            color: 'rgba(0, 0, 0, 0,1)',\n            handleStyle: {\n              left: {\n                backgroundColor: 'rgb(63, 138, 224)',\n                width: '6px',\n              },\n              right: {\n                backgroundColor: 'rgb(63, 138, 224)',\n                width: '6px',\n              },\n            },\n          });\n          selectionReg.on('update-end', () => {\n            // make a desicion if we can edit audio\n            if (selectionRegion && wavesurfer) {\n              const selectedStart = selectionRegion.start === 0;\n              const selectedEnd = selectionRegion.end === wavesurfer?.getDuration();\n              if (selectedStart && selectedEnd && isEditable) {\n                setIsEditable(false);\n              }\n            } else if (!isEditable) {\n              setIsEditable(true);\n            }\n          });\n          setSelectionRegion(selectionReg);\n        }\n      });\n\n      setDidMount(true);\n      setWavesurfer(wavesurfer);\n    }\n    if (wavesurfer) {\n      if (shouldMusicPlay) {\n        wavesurfer.play();\n      } else if (wavesurfer.isPlaying()) {\n        wavesurfer.pause();\n      }\n    }\n\n    // stop playing podcast on unmoun\n    return () => {\n      if (wavesurfer && wavesurfer.isPlaying()) {\n        wavesurfer.pause();\n      }\n    };\n  }, [shouldMusicPlay, wavesurfer]);\n\n  const cutAudio = () => {\n    console.log('wefwfewef cut cut cut')\n    if (selectionRegion && wavesurfer) {\n      setIsBlobLoading(true);\n      // get region positions and remove it\n      const start: number = selectionRegion.start;\n      const end: number = selectionRegion.end;\n      selectionRegion.remove();\n      setSelectionRegion(null);\n      setIsEditable(false);\n      // create audio context\n      const ctx = createAudioCtx();\n      createAudioBufferFromFile(\n        audioFile!,\n        ctx,\n        (buffer) => {\n          // slice buffer\n          const sllicedBuffer = audioBufferSlice(ctx, buffer, start, end);\n          // add history record\n          setEditStory([...editStory, currentBuffer]);\n          setCurrentBuffer(sllicedBuffer);\n          // load buffer to wavesurfer\n          wavesurfer.backend.load(sllicedBuffer);\n          wavesurfer.drawBuffer();\n          wavesurfer.isReady = true;\n          wavesurfer.fireEvent('ready');\n        },\n      );\n    }\n  }\n\n  const undoCutAudio = () => {\n    if (editStory.length > 0 && wavesurfer) {\n      const prevBuffer = editStory[editStory.length - 1];\n      wavesurfer.backend.load(prevBuffer);\n      wavesurfer.drawBuffer();\n      wavesurfer.isReady = true;\n      wavesurfer.fireEvent('ready');\n      // new story\n      setEditStory([...editStory.slice(0, editStory.length - 1)])\n\n    }\n  }\n\n  const editStyles = isEditable\n    ? {}\n    : { opacity: 0.5, pointerEvents: 'none' };\n  const storyStyles = editStory.length > 0\n    ? {}\n    : { opacity: 0.5, pointerEvents: 'none' };\n\n  return (\n    <Group separator=\"hide\">\n      <CardGrid>\n        <Card size=\"l\" mode=\"outline\">\n          <div\n            id=\"timeline\"\n            style={{ height: 26, background: 'var(--field_background)' }}\n            className=\"timeline-border\"\n          />\n\n          <Separator wide />\n\n          <div\n            id=\"waveform\"\n            style={{ height: 96, background: 'var(--field_background)' }}\n          />\n\n          <div style={{ padding: 8 }}>\n            {isBlobLoading && (\n              <Spinner size=\"medium\" style={{ minHeight: 44 }} />\n            )}\n            {!isBlobLoading && (\n              <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                <Button\n                  style={{ width: 44 }}\n                  before={shouldMusicPlay ? <Icon24Pause /> : <Icon24Play />}\n                  onClick={() => setShouldMusicPlay(!shouldMusicPlay)}\n                  size=\"l\"\n                />\n                <div>\n                  <Button\n                    style={{ width: 44, marginRight: 4, ...editStyles }}\n                    before={<Icon24Cut />}\n                    onClick={cutAudio}\n                    size=\"l\"\n                    mode=\"secondary\"\n                  />\n                  <Button\n                    style={{ width: 44, ...storyStyles }}\n                    before={<Icon24ArrowUturnLeftOutline />}\n                    onClick={undoCutAudio}\n                    size=\"l\"\n                    mode=\"secondary\"\n                  />\n                </div>\n                <div>\n                  <Button\n                    style={{ width: 44, marginRight: 4 }}\n                    before={<Icon24Music />}\n                    size=\"l\"\n                    mode=\"secondary\"\n                  />\n                  <Button\n                    style={{ width: 44, marginRight: 4 }}\n                    before={<Icon24ChartUp />}\n                    size=\"l\"\n                    mode=\"secondary\"\n                  />\n                  <Button\n                    style={{ width: 44 }}\n                    before={<Icon24ChartDown />}\n                    size=\"l\"\n                    mode=\"secondary\"\n                  />\n                </div>\n              </div>\n            )}\n          </div>\n        </Card>\n      </CardGrid>\n    </Group>\n  );\n};\n\nexport default AudioEditor;\n"]}