{"version":3,"sources":["region.js"],"names":["Region","constructor","params","regionsUtils","ws","wavesurfer","wrapper","drawer","util","style","regionsUtil","id","getId","start","Number","end","scrollWidth","getDuration","resize","undefined","Boolean","drag","isResizing","isDragging","loop","color","handleStyle","left","right","data","attributes","maxLength","minLength","_onRedraw","updateRender","scroll","scrollParent","scrollSpeed","scrollThreshold","preventContextMenu","channelIdx","parseInt","regionHeight","marginTop","channelCount","backend","buffer","numberOfChannels","Math","floor","getHeight","formatTimeCallback","bindInOut","render","on","fireEvent","update","remove","element","removeChild","un","play","s","playLoop","once","realTime","getCurrentTime","regionEl","document","createElement","className","title","formatTime","setAttribute","attrname","position","zIndex","height","top","handleLeft","appendChild","bordersDiv","handleRight","css","cursor","width","maxWidth","backgroundColor","handleLeftCss","Object","assign","handleRightCss","border","borderColor","bindEvents","map","time","slice","join","getWidth","pixelRatio","dur","startLimited","endLimited","max","min","round","regionWidth","firedIn","firedOut","onProcess","addEventListener","e","stopPropagation","preventDefault","bindDragEvents","container","startTime","touchId","maxScroll","updated","scrollDirection","wrapperRect","edgeScroll","duration","scrollLeft","getRegionSnapToGridValue","handleEvent","delta","onDrag","onResize","window","requestAnimationFrame","onDown","touches","length","targetTouches","identifier","clientWidth","getBoundingClientRect","target","tagName","toLowerCase","classList","contains","onUp","preventClick","onMove","oldTime","regionRect","x","clientX","body","removeEventListener","maxEnd","direction"],"mappings":"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","sourcesContent":["/**\n *  @since 4.0.0\n *\n * (Single) Region plugin class\n *\n * Must be turned into an observer before instantiating. This is done in\n * `RegionsPlugin` (main plugin class).\n *\n * @extends {Observer}\n */\nexport class Region {\n  constructor(params, regionsUtils, ws) {\n    this.wavesurfer = ws;\n    this.wrapper = ws.drawer.wrapper;\n    this.util = ws.util;\n    this.style = this.util.style;\n    this.regionsUtil = regionsUtils;\n\n    this.id = params.id == null ? ws.util.getId() : params.id;\n    this.start = Number(params.start) || 0;\n    this.end =\n      params.end == null // small marker-like region\n        ? this.start +\n          (4 / this.wrapper.scrollWidth) * this.wavesurfer.getDuration()\n        : Number(params.end);\n    this.resize = params.resize === undefined ? true : Boolean(params.resize);\n    this.drag = params.drag === undefined ? true : Boolean(params.drag);\n    // reflect resize and drag state of region for region-updated listener\n    this.isResizing = false;\n    this.isDragging = false;\n    this.loop = Boolean(params.loop);\n    this.color = params.color || 'rgba(0, 0, 0, 0.1)';\n    // The left and right handleStyle properties can be set to 'none' for\n    // no styling or can be assigned an object containing CSS properties.\n    this.handleStyle = params.handleStyle || {\n      left: {},\n      right: {},\n    };\n    this.data = params.data || {};\n    this.attributes = params.attributes || {};\n\n    this.maxLength = params.maxLength;\n    this.minLength = params.minLength;\n    this._onRedraw = () => this.updateRender();\n\n    this.scroll = params.scroll !== false && ws.params.scrollParent;\n    this.scrollSpeed = params.scrollSpeed || 1;\n    this.scrollThreshold = params.scrollThreshold || 10;\n    // Determines whether the context menu is prevented from being opened.\n    this.preventContextMenu =\n      params.preventContextMenu === undefined\n        ? false\n        : Boolean(params.preventContextMenu);\n\n    // select channel ID to set region\n    let channelIdx =\n      params.channelIdx == null ? -1 : parseInt(params.channelIdx);\n    this.regionHeight = '100%';\n    this.marginTop = '0px';\n\n    if (channelIdx !== -1) {\n      let channelCount =\n        this.wavesurfer.backend.buffer != null\n          ? this.wavesurfer.backend.buffer.numberOfChannels\n          : -1;\n      if (channelCount >= 0 && channelIdx < channelCount) {\n        this.regionHeight = Math.floor((1 / channelCount) * 100) + '%';\n        this.marginTop = this.wavesurfer.getHeight() * channelIdx + 'px';\n      }\n    }\n\n    this.formatTimeCallback = params.formatTimeCallback;\n\n    this.bindInOut();\n    this.render();\n    this.wavesurfer.on('zoom', this._onRedraw);\n    this.wavesurfer.on('redraw', this._onRedraw);\n    this.wavesurfer.fireEvent('region-created', this);\n  }\n\n  /* Update region params. */\n  update(params) {\n    if (params.start != null) {\n      this.start = Number(params.start);\n    }\n    if (params.end != null) {\n      this.end = Number(params.end);\n    }\n    if (params.loop != null) {\n      this.loop = Boolean(params.loop);\n    }\n    if (params.color != null) {\n      this.color = params.color;\n    }\n    if (params.handleStyle != null) {\n      this.handleStyle = params.handleStyle;\n    }\n    if (params.data != null) {\n      this.data = params.data;\n    }\n    if (params.resize != null) {\n      this.resize = Boolean(params.resize);\n    }\n    if (params.drag != null) {\n      this.drag = Boolean(params.drag);\n    }\n    if (params.maxLength != null) {\n      this.maxLength = Number(params.maxLength);\n    }\n    if (params.minLength != null) {\n      this.minLength = Number(params.minLength);\n    }\n    if (params.attributes != null) {\n      this.attributes = params.attributes;\n    }\n\n    this.updateRender();\n    this.fireEvent('update');\n    this.wavesurfer.fireEvent('region-updated', this);\n  }\n\n  /* Remove a single region. */\n  remove() {\n    if (this.element) {\n      this.wrapper.removeChild(this.element);\n      this.element = null;\n      this.fireEvent('remove');\n      this.wavesurfer.un('zoom', this._onRedraw);\n      this.wavesurfer.un('redraw', this._onRedraw);\n      this.wavesurfer.fireEvent('region-removed', this);\n    }\n  }\n\n  /**\n   * Play the audio region.\n   * @param {number} start Optional offset to start playing at\n   */\n  play(start) {\n    const s = start || this.start;\n    this.wavesurfer.play(s, this.end);\n    this.fireEvent('play');\n    this.wavesurfer.fireEvent('region-play', this);\n  }\n\n  /**\n   * Play the audio region in a loop.\n   * @param {number} start Optional offset to start playing at\n   * */\n  playLoop(start) {\n    const s = start || this.start;\n    this.wavesurfer.play(s);\n    this.once('out', () => {\n      const realTime = this.wavesurfer.getCurrentTime();\n      if (realTime >= this.start && realTime <= this.end) {\n        return this.playLoop();\n      }\n    });\n  }\n\n  /* Render a region as a DOM element. */\n  render() {\n    const regionEl = document.createElement('region');\n\n    regionEl.className = 'wavesurfer-region';\n    regionEl.title = this.formatTime(this.start, this.end);\n    regionEl.setAttribute('data-id', this.id);\n\n    for (const attrname in this.attributes) {\n      regionEl.setAttribute(\n        'data-region-' + attrname,\n        this.attributes[attrname],\n      );\n    }\n\n    this.style(regionEl, {\n      position: 'absolute',\n      zIndex: 2,\n      height: this.regionHeight,\n      top: this.marginTop,\n    });\n\n    /* Resize handles */\n    if (this.resize) {\n      const handleLeft = regionEl.appendChild(document.createElement('handle'));\n      const bordersDiv = document.createElement('div');\n      regionEl.appendChild(bordersDiv);\n      const handleRight = regionEl.appendChild(\n        document.createElement('handle'),\n      );\n\n      handleLeft.className = 'wavesurfer-handle wavesurfer-handle-start';\n      handleRight.className = 'wavesurfer-handle wavesurfer-handle-end';\n\n      // Default CSS properties for both handles.\n      const css = {\n        cursor: 'col-resize',\n        position: 'absolute',\n        top: '0px',\n        width: '1%',\n        maxWidth: '4px',\n        height: '96px',\n        backgroundColor: 'rgba(0, 0, 0, 1)',\n      };\n\n      // Merge CSS properties per handle.\n      const handleLeftCss =\n        this.handleStyle.left !== 'none'\n          ? Object.assign({ left: '0px' }, css, this.handleStyle.left)\n          : null;\n\n      const handleRightCss =\n        this.handleStyle.right !== 'none'\n          ? Object.assign({ right: '0px' }, css, this.handleStyle.right)\n          : null;\n\n      if (handleLeftCss) {\n        this.style(handleLeft, handleLeftCss);\n      }\n\n      if (bordersDiv) {\n        this.style(bordersDiv, {\n          height: '94px',\n          border: '1px solid',\n          borderColor: 'rgb(63, 138, 224)',\n        });\n      }\n\n      if (handleRightCss) {\n        this.style(handleRight, handleRightCss);\n      }\n    }\n\n    this.element = this.wrapper.appendChild(regionEl);\n    this.updateRender();\n    this.bindEvents(regionEl);\n  }\n\n  formatTime(start, end) {\n    if (this.formatTimeCallback) {\n      return this.formatTimeCallback(start, end);\n    }\n    return (start == end ? [start] : [start, end])\n      .map((time) =>\n        [\n          Math.floor((time % 3600) / 60), // minutes\n          ('00' + Math.floor(time % 60)).slice(-2), // seconds\n        ].join(':'),\n      )\n      .join('-');\n  }\n\n  getWidth() {\n    return this.wavesurfer.drawer.width / this.wavesurfer.params.pixelRatio;\n  }\n\n  /* Update element's position, width, color. */\n  updateRender() {\n    // duration varies during loading process, so don't overwrite important data\n    const dur = this.wavesurfer.getDuration();\n    const width = this.getWidth();\n\n    var startLimited = this.start;\n    var endLimited = this.end;\n    if (startLimited < 0) {\n      startLimited = 0;\n      endLimited = endLimited - startLimited;\n    }\n    if (endLimited > dur) {\n      endLimited = dur;\n      startLimited = dur - (endLimited - startLimited);\n    }\n\n    if (this.minLength != null) {\n      endLimited = Math.max(startLimited + this.minLength, endLimited);\n    }\n\n    if (this.maxLength != null) {\n      endLimited = Math.min(startLimited + this.maxLength, endLimited);\n    }\n\n    if (this.element != null) {\n      // Calculate the left and width values of the region such that\n      // no gaps appear between regions.\n      const left = Math.round((startLimited / dur) * width);\n      const regionWidth = Math.round((endLimited / dur) * width) - left;\n\n      this.style(this.element, {\n        left: left + 'px',\n        width: regionWidth + 'px',\n        backgroundColor: this.color,\n        cursor: this.drag ? 'move' : 'default',\n      });\n\n      for (const attrname in this.attributes) {\n        this.element.setAttribute(\n          'data-region-' + attrname,\n          this.attributes[attrname],\n        );\n      }\n\n      this.element.title = this.formatTime(this.start, this.end);\n    }\n  }\n\n  /* Bind audio events. */\n  bindInOut() {\n    this.firedIn = false;\n    this.firedOut = false;\n\n    const onProcess = (time) => {\n      let start = Math.round(this.start * 10) / 10;\n      let end = Math.round(this.end * 10) / 10;\n      time = Math.round(time * 10) / 10;\n\n      if (!this.firedOut && this.firedIn && (start > time || end <= time)) {\n        this.firedOut = true;\n        this.firedIn = false;\n        this.fireEvent('out');\n        this.wavesurfer.fireEvent('region-out', this);\n      }\n      if (!this.firedIn && start <= time && end > time) {\n        this.firedIn = true;\n        this.firedOut = false;\n        this.fireEvent('in');\n        this.wavesurfer.fireEvent('region-in', this);\n      }\n    };\n\n    this.wavesurfer.backend.on('audioprocess', onProcess);\n\n    this.on('remove', () => {\n      this.wavesurfer.backend.un('audioprocess', onProcess);\n    });\n\n    /* Loop playback. */\n    this.on('out', () => {\n      if (this.loop) {\n        this.wavesurfer.play(this.start);\n      }\n    });\n  }\n\n  /* Bind DOM events. */\n  bindEvents() {\n    const preventContextMenu = this.preventContextMenu;\n\n    this.element.addEventListener('mouseenter', (e) => {\n      this.fireEvent('mouseenter', e);\n      this.wavesurfer.fireEvent('region-mouseenter', this, e);\n    });\n\n    this.element.addEventListener('mouseleave', (e) => {\n      this.fireEvent('mouseleave', e);\n      this.wavesurfer.fireEvent('region-mouseleave', this, e);\n    });\n\n    this.element.addEventListener('click', (e) => {\n      e.stopPropagation();\n      e.preventDefault();\n      this.fireEvent('click', e);\n      this.wavesurfer.fireEvent('region-click', this, e);\n    });\n\n    this.element.addEventListener('dblclick', (e) => {\n      e.stopPropagation();\n      e.preventDefault();\n      this.fireEvent('dblclick', e);\n      this.wavesurfer.fireEvent('region-dblclick', this, e);\n    });\n\n    this.element.addEventListener('contextmenu', (e) => {\n      if (preventContextMenu) {\n        e.preventDefault();\n      }\n      this.fireEvent('contextmenu', e);\n      this.wavesurfer.fireEvent('region-contextmenu', this, e);\n    });\n\n    /* Drag or resize on mousemove. */\n    if (this.drag || this.resize) {\n      this.bindDragEvents();\n    }\n  }\n\n  bindDragEvents() {\n    const container = this.wavesurfer.drawer.container;\n    const scrollSpeed = this.scrollSpeed;\n    const scrollThreshold = this.scrollThreshold;\n    let startTime;\n    let touchId;\n    let drag;\n    let maxScroll;\n    let resize;\n    let updated = false;\n    let scrollDirection;\n    let wrapperRect;\n\n    // Scroll when the user is dragging within the threshold\n    const edgeScroll = (e) => {\n      const duration = this.wavesurfer.getDuration();\n      if (!scrollDirection || (!drag && !resize)) {\n        return;\n      }\n\n      // Update scroll position\n      let scrollLeft = this.wrapper.scrollLeft + scrollSpeed * scrollDirection;\n      this.wrapper.scrollLeft = scrollLeft = Math.min(\n        maxScroll,\n        Math.max(0, scrollLeft),\n      );\n\n      // Get the currently selected time according to the mouse position\n      const time = this.regionsUtil.getRegionSnapToGridValue(\n        this.wavesurfer.drawer.handleEvent(e) * duration,\n      );\n      const delta = time - startTime;\n      startTime = time;\n\n      // Continue dragging or resizing\n      drag ? this.onDrag(delta) : this.onResize(delta, resize);\n\n      // Repeat\n      window.requestAnimationFrame(() => {\n        edgeScroll(e);\n      });\n    };\n\n    const onDown = (e) => {\n      const duration = this.wavesurfer.getDuration();\n      if (e.touches && e.touches.length > 1) {\n        return;\n      }\n      touchId = e.targetTouches ? e.targetTouches[0].identifier : null;\n\n      // stop the event propagation, if this region is resizable or draggable\n      // and the event is therefore handled here.\n      if (this.drag || this.resize) {\n        e.stopPropagation();\n      }\n\n      // Store the selected startTime we begun dragging or resizing\n      startTime = this.regionsUtil.getRegionSnapToGridValue(\n        this.wavesurfer.drawer.handleEvent(e, true) * duration,\n      );\n\n      // Store for scroll calculations\n      maxScroll = this.wrapper.scrollWidth - this.wrapper.clientWidth;\n      wrapperRect = this.wrapper.getBoundingClientRect();\n\n      this.isResizing = false;\n      this.isDragging = false;\n      if (e.target.tagName.toLowerCase() === 'handle') {\n        this.isResizing = true;\n        resize = e.target.classList.contains('wavesurfer-handle-start')\n          ? 'start'\n          : 'end';\n      } else {\n        this.isDragging = true;\n        drag = true;\n        resize = false;\n      }\n    };\n    const onUp = (e) => {\n      if (e.touches && e.touches.length > 1) {\n        return;\n      }\n\n      if (drag || resize) {\n        this.isDragging = false;\n        this.isResizing = false;\n        drag = false;\n        scrollDirection = null;\n        resize = false;\n      }\n\n      if (updated) {\n        updated = false;\n        this.util.preventClick();\n        this.fireEvent('update-end', e);\n        this.wavesurfer.fireEvent('region-update-end', this, e);\n      }\n    };\n    const onMove = (e) => {\n      const duration = this.wavesurfer.getDuration();\n\n      if (e.touches && e.touches.length > 1) {\n        return;\n      }\n      if (e.targetTouches && e.targetTouches[0].identifier != touchId) {\n        return;\n      }\n      if (!drag && !resize) {\n        return;\n      }\n\n      const oldTime = startTime;\n      const time = this.regionsUtil.getRegionSnapToGridValue(\n        this.wavesurfer.drawer.handleEvent(e) * duration,\n      );\n\n      const delta = time - startTime;\n      startTime = time;\n\n      // Drag\n      if (this.drag && drag) {\n        updated = updated || !!delta;\n        this.onDrag(delta);\n      }\n\n      // Resize\n      if (this.resize && resize) {\n        updated = updated || !!delta;\n        this.onResize(delta, resize);\n      }\n\n      if (this.scroll && container.clientWidth < this.wrapper.scrollWidth) {\n        if (drag) {\n          // The threshold is not between the mouse and the container edge\n          // but is between the region and the container edge\n          const regionRect = this.element.getBoundingClientRect();\n          let x = regionRect.left - wrapperRect.left;\n\n          // Check direction\n          if (time < oldTime && x >= 0) {\n            scrollDirection = -1;\n          } else if (\n            time > oldTime &&\n            x + regionRect.width <= wrapperRect.right\n          ) {\n            scrollDirection = 1;\n          }\n\n          // Check that we are still beyond the threshold\n          if (\n            (scrollDirection === -1 && x > scrollThreshold) ||\n            (scrollDirection === 1 &&\n              x + regionRect.width < wrapperRect.right - scrollThreshold)\n          ) {\n            scrollDirection = null;\n          }\n        } else {\n          // Mouse based threshold\n          let x = e.clientX - wrapperRect.left;\n\n          // Check direction\n          if (x <= scrollThreshold) {\n            scrollDirection = -1;\n          } else if (x >= wrapperRect.right - scrollThreshold) {\n            scrollDirection = 1;\n          } else {\n            scrollDirection = null;\n          }\n        }\n\n        if (scrollDirection) {\n          edgeScroll(e);\n        }\n      }\n    };\n\n    this.element.addEventListener('mousedown', onDown);\n    this.element.addEventListener('touchstart', onDown);\n\n    this.wrapper.addEventListener('mousemove', onMove);\n    this.wrapper.addEventListener('touchmove', onMove);\n\n    document.body.addEventListener('mouseup', onUp);\n    document.body.addEventListener('touchend', onUp);\n\n    this.on('remove', () => {\n      document.body.removeEventListener('mouseup', onUp);\n      document.body.removeEventListener('touchend', onUp);\n      this.wrapper.removeEventListener('mousemove', onMove);\n      this.wrapper.removeEventListener('touchmove', onMove);\n    });\n\n    this.wavesurfer.on('destroy', () => {\n      document.body.removeEventListener('mouseup', onUp);\n      document.body.removeEventListener('touchend', onUp);\n    });\n  }\n\n  onDrag(delta) {\n    const maxEnd = this.wavesurfer.getDuration();\n    if (this.end + delta > maxEnd || this.start + delta < 0) {\n      return;\n    }\n\n    this.update({\n      start: this.start + delta,\n      end: this.end + delta,\n    });\n  }\n\n  onResize(delta, direction) {\n    if (direction === 'start') {\n      this.update({\n        start: Math.min(this.start + delta, this.end),\n        end: Math.max(this.start + delta, this.end),\n      });\n    } else {\n      this.update({\n        start: Math.min(this.end + delta, this.start),\n        end: Math.max(this.end + delta, this.start),\n      });\n    }\n  }\n}\n"]}